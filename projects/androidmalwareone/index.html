<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Sample hash: cf661506978f088f276a5a5bc4f0ea71101f99941840dd0864b2068ee2eb2271
In this project, I will be detailing the steps that I took when analyzing a malicious sample after completing Maddie Stones Android Reverse Engineering 101 course. I found the course an excellent practical introduction and overview of reverse engineering mobile malware.
The course is available at https://maddiestone.github.io/AndroidAppRE/ if your interested I can&amp;rsquo;t recommend it an enough.
As for the APK itself, the sample was found around September time back in 2019 and was added to sk3ptre malware samples Github repository in February 2020." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/projects/androidmalwareone/" />


    <title>
        
            Android Premium SMS Malware Analysis :: Paul (xLkn) 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.5dcefbf8102eb536dd3e2de53ffebfa58599ab2435c241a0db81728a5e015f2e.css">




<meta itemprop="name" content="Android Premium SMS Malware Analysis">
<meta itemprop="description" content="Sample hash: cf661506978f088f276a5a5bc4f0ea71101f99941840dd0864b2068ee2eb2271
In this project, I will be detailing the steps that I took when analyzing a malicious sample after completing Maddie Stones Android Reverse Engineering 101 course. I found the course an excellent practical introduction and overview of reverse engineering mobile malware.
The course is available at https://maddiestone.github.io/AndroidAppRE/ if your interested I can&rsquo;t recommend it an enough.
As for the APK itself, the sample was found around September time back in 2019 and was added to sk3ptre malware samples Github repository in February 2020.">
<meta itemprop="datePublished" content="2020-03-18T08:19:11&#43;00:00" />
<meta itemprop="dateModified" content="2020-03-18T08:19:11&#43;00:00" />
<meta itemprop="wordCount" content="395">
<meta itemprop="image" content="/"/>



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="Android Premium SMS Malware Analysis"/>
<meta name="twitter:description" content="Sample hash: cf661506978f088f276a5a5bc4f0ea71101f99941840dd0864b2068ee2eb2271
In this project, I will be detailing the steps that I took when analyzing a malicious sample after completing Maddie Stones Android Reverse Engineering 101 course. I found the course an excellent practical introduction and overview of reverse engineering mobile malware.
The course is available at https://maddiestone.github.io/AndroidAppRE/ if your interested I can&rsquo;t recommend it an enough.
As for the APK itself, the sample was found around September time back in 2019 and was added to sk3ptre malware samples Github repository in February 2020."/>





    <meta property="article:published_time" content="2020-03-18 08:19:11 &#43;0000 GMT" />








    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=""></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/posts">Posts</a></li><li><a href="/projects">Projects</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="/projects/androidmalwareone/">Android Premium SMS Malware Analysis</a></h2>

            

            <div class="post-content">
                <p>Sample hash: cf661506978f088f276a5a5bc4f0ea71101f99941840dd0864b2068ee2eb2271</p>
<p>In this project, I will be detailing the steps that I took when analyzing a malicious sample after completing Maddie Stones Android Reverse Engineering 101 course. I found the course an excellent practical introduction and overview of reverse engineering mobile malware.</p>
<p>The course is available at <a href="https://maddiestone.github.io/AndroidAppRE/">https://maddiestone.github.io/AndroidAppRE/</a> if your interested I can&rsquo;t recommend it an enough.</p>
<p>As for the APK itself, the sample was found around September time back in 2019 and was added to sk3ptre malware samples Github repository in February 2020. It Infected an application called “Treatment for Diabetes”. When installed it will ask for SMS permissions, making the sample immediately suspicious.</p>
<h2 id="hahahugoshortcode-s0-hbhb">
    <img src="/img/Treatment/sms.png"  class="center"  />

</h2>
<p>Within Jadx you can see that the send SMS permission is added to the bottom of the AndroidMainfest.xml possibly to throw people off as there is normally declared at the start of the file.</p>
<h2 id="hahahugoshortcode-s1-hbhb">
    <img src="/img/Treatment/mainifestSmall.png"  class="center"  />

</h2>
<p>Throughout the rest of the application, the author had used code obfuscation for method names which I haven&rsquo;t decode as I quickly scanned the code to get an understanding of the functionality at this point.</p>
<p>Continuing, below you can see within MainDev there is a method and call to SMS Manager and DataHelper. The variable m is assigned and passed into each of the try-catch blocks. Where my assumption was that it is requesting the default SMS manager method and calling send SMS to the short code if possible. Else recording an error and passing this data to DataHelper DH which we can see if the last line of code outside the block.</p>
<h2 id="hahahugoshortcode-s2-hbhb">
    <img src="/img/Treatment/loop.png"  class="center"  />

</h2>
<p>The DataHelper class was of further interest as I wanted to check what interaction if any was happening when data from MainDev was or wasn’t being passed into the database. Below it is recording if the message was sent and placing ‘was’ in the SQL table and if not the result equalled ‘no’.</p>
<h2 id="hahahugoshortcode-s3-hbhb">
    <img src="/img/Treatment/dhDev.png"  class="center"  />

</h2>

    <img src="/img/Treatment/database.png"  class="center"  />


<p>Overall I enjoyed the learning more about reversing and analysing Android malware.  Even with the obfuscation, it was possible to work out how the sample functioned based on what I have seen in previous malware. While doing follow up research on the obfuscation method used, I came across a write up by Fortinet confirming my assumptions where they have de-obfuscated the APK. You can see that the sample makes requests to premium SMS numbers and passes the data into the DataHelper.</p>
<p>You can find Fortinets writeup at <a href="https://www.fortinet.com/blog/threat-research/android-malware-targets-diabetic-patients.html">https://www.fortinet.com/blog/threat-research/android-malware-targets-diabetic-patients.html</a></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            
            
            <span>&copy; Paul Larkin </span>
            <span> 2020</span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
       </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>



    </body>
</html>
